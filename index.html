<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SafePassAI ‚Äî –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    .tab-buttons {
      text-align: center;
      margin: 20px 0;
    }
    .tab-button {
      margin: 0 5px;
      padding: 10px 20px;
      background-color: #eee;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    .tab-button.active {
      background-color: #4CAF50;
      color: white;
    }
    .tab-content {
      display: none;
    }
    .tab-content.active {
      display: block;
    }
    .loading { color: gray; }
    .error { color: red; }
    .success { color: green; }
    .warning { color: orange; }
  </style>
</head>
<body>
  <header>
  <div class="navbar container">
    <button class="hamburger" id="hamburgerBtn">‚ò∞</button>
    <div class="nav-left" id="navMenu">
      <a href="https://t.me/SafePassAIBot" target="_blank">TG-–±–æ—Ç</a>
      <a href="/" class="active">–ü—Ä–æ–≤–µ—Ä–∫–∞</a>
      <a href="/generate">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è</a>
      <a href="/security">–ë–ª–æ–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</a>
      <a href="/about">–û –ø—Ä–æ–µ–∫—Ç–µ</a>
    </div>
    <div class="nav-right">
      <h1>SafePassAI</h1>
    </div>
  </div>
</header>

  <main class="container">
    <div class="tab-buttons">
      <button class="tab-button active" data-tab="leak">–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫</button>
      <button class="tab-button" data-tab="common">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–∞—Ä–æ–ª–∏</button>
      <button class="tab-button" data-tab="generator">–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª–æ–≤–∞—Ä–µ–π</button>
    </div>

    <section id="tab-leak" class="tab-content active">
      <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫</h2>
      <p>–í–≤–µ–¥–∏—Ç–µ email –∏–ª–∏ –ª–æ–≥–∏–Ω:</p>
      <form id="leakCheckForm">
        <input type="text" id="queryInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ..." required />
        <button type="submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
      </form>
      <div id="result"></div>
    </section>

    <section id="tab-common" class="tab-content">
      <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –Ω–∞ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å</h2>
      <p>–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å (–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è):</p>
      <form id="passwordCheckForm">
        <input type="password" id="passwordInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å..." required />
        <button type="submit">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
      </form>
      <div id="passwordResult"></div>
    </section>

    <div style="text-align:center">
      <button id="donate-btn" class="donate-button">‚ù§Ô∏è –ü–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–æ–µ–∫—Ç</button>
    </div>

    <div id="donate-popup" style="display:none;">
      <h3>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –ø–æ–¥–¥–µ—Ä–∂–∫—É!</h3>
      <p>–ü–æ–¥–¥–µ—Ä–∂–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:</p>
      <a href="https://pay.cloudtips.ru/p/50385217" target="_blank" style="display: inline-block; padding: 10px 20px; background-color: #4CAF50; color: white; font-size: 18px; text-decoration: none; border-radius: 6px; margin: 10px 0;">
        –ü–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ
      </a>
      <p>–õ—é–±–∞—è —Å—É–º–º–∞ –≤–∞–∂–Ω–∞</p>
      <button id="donate-close">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </main>

  <footer>
    <p>¬© 2025 SafePassAI</p>
  </footer>

  <script>
    // üîÅ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
    document.querySelectorAll('.tab-button').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');

        document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
        document.getElementById('tab-' + button.dataset.tab).classList.add('active');
      });
    });

    // üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ç–µ—á–µ–∫
    document.getElementById('leakCheckForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      const query = document.getElementById('queryInput').value;
      const resultDiv = document.getElementById('result');
      resultDiv.innerHTML = '<p class="loading">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</p>';

      try {
        const response = await fetch('https://safe-pass-api.onrender.com/check?query=' + encodeURIComponent(query));
        const data = await response.json();

        if (data && data.found) {
          let html = `<p class="success">–ù–∞–π–¥–µ–Ω—ã —É—Ç–µ—á–∫–∏: ${data.found}</p><ul>`;
          data.results.forEach(item => {
            html += `<li>${item.name || item.source}</li>`;
          });
          html += '</ul>';
          resultDiv.innerHTML = html;
        } else {
          resultDiv.innerHTML = '<p class="warning">–£—Ç–µ—á–µ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>';
        }
      } catch (err) {
        resultDiv.innerHTML = '<p class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</p>';
      }
    });

    // üìâ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
    document.getElementById('passwordCheckForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      const password = document.getElementById('passwordInput').value;
      const resultDiv = document.getElementById('passwordResult');
      resultDiv.innerHTML = '<p class="loading">–ü—Ä–æ–≤–µ—Ä—è–µ–º...</p>';

      try {
        const response = await fetch('https://safe-pass-api.onrender.com/check-password', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ password }),
        });
        const data = await response.json();
        resultDiv.innerHTML = data.is_common
          ? `<p class="error">${data.message}</p>`
          : `<p class="success">${data.message}</p>`;
      } catch (err) {
        resultDiv.innerHTML = '<p class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</p>';
      }
    });

    // üß† –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ª–æ–≤–∞—Ä—è
    document.getElementById('wordlistForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      const name = document.getElementById('nameInput').value;
      const city = document.getElementById('cityInput').value;
      const year = document.getElementById('yearInput').value;
      const resultDiv = document.getElementById('wordlistResult');
      resultDiv.innerHTML = '<p class="loading">–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º...</p>';

      try {
        const response = await fetch('https://safe-pass-api.onrender.com/generate-passwords', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, city, year }),
        });
        const data = await response.json();

        if (data.passwords) {
          let html = '<p class="success">–í–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏:</p><ul>';
          data.passwords.forEach(pw => html += `<li>${pw}</li>`);
          html += '</ul>';
          resultDiv.innerHTML = html;
        } else {
          resultDiv.innerHTML = '<p class="error">–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.</p>';
        }
      } catch (err) {
        resultDiv.innerHTML = '<p class="error">–û—à–∏–±–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.</p>';
      }
    });

    // Popup
    document.querySelectorAll('#donate-btn').forEach(btn => {
      btn.addEventListener('click', e => {
        e.preventDefault();
        document.getElementById('donate-popup').style.display = 'block';
      });
    });
    document.getElementById('donate-close').addEventListener('click', () => {
      document.getElementById('donate-popup').style.display = 'none';
    });
  
    // ü§ñ –ê–∫–∏–Ω–∞—Ç–æ—Ä-–ø–∞—Ä–æ–ª–µ–π
    let akinatorBool = {}, akinatorText = {}, akinatorFollowups = [];

    async function loadAkinatorQuestions() {
      const res = await fetch("http://localhost:8000/get-questions");
      const data = await res.json();
      const container = document.getElementById("akinator-questions");
      container.innerHTML = '';
      data.questions.forEach(q => {
        const div = document.createElement("div");
        div.className = "question-block";
        div.innerHTML = `
          <p>${q.question}</p>
          <label><input type="radio" name="${q.id}" value="true" onchange="akinatorBool['${q.id}'] = true"> –î–∞</label>
          <label><input type="radio" name="${q.id}" value="false" onchange="akinatorBool['${q.id}'] = false"> –ù–µ—Ç</label>
        `;
        container.appendChild(div);
      });
    }

    async function submitAkinator() {
      const res = await fetch("http://localhost:8000/get-followups", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(akinatorBool),
      });
      const data = await res.json();
      akinatorFollowups = data.followups;
      const container = document.getElementById("akinator-followups");
      container.innerHTML = '';
      akinatorFollowups.forEach(q => {
        const div = document.createElement("div");
        div.innerHTML = `
          <p>${q.question}</p>
          <input type="text" onchange="akinatorText['${q.id}'] = this.value">
        `;
        container.appendChild(div);
      });

      const btn = document.createElement("button");
      btn.textContent = "–£–≥–∞–¥–∞—Ç—å –ø–∞—Ä–æ–ª–∏";
      btn.onclick = guessAkinatorPasswords;
      container.appendChild(btn);
    }

    async function guessAkinatorPasswords() {
      const res = await fetch("http://localhost:8000/guess-passwords", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ bools: akinatorBool, texts: akinatorText }),
      });
      const data = await res.json();
      const results = document.getElementById("akinator-results");
      results.innerHTML = "<h4>–í–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏:</h4>";
      data.guesses.forEach(g => {
        const div = document.createElement("div");
        div.textContent = "‚Ä¢ " + g;
        results.appendChild(div);
      });
    }

    // –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞
    loadAkinatorQuestions();

</script>
</body>
</html>
